<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ page import="java.time.LocalDateTime" %>
<%@ page import="com.swasthopd.model.User" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>

<%
    String visitTime = LocalDateTime.now().toString().replace("T", " ");
    User doctor = (User) session.getAttribute("loggedInUser");
%>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>New Patient Registration | SWASTH OPD+</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/dashboard.css">
    <style>
        .registration-card {
            background: #fff;
            max-width: 900px;
            margin: auto;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        .form-label {
            font-weight: 500;
        }
        .form-section-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 8px;
        }
        .btn-group {
            display: flex;
            justify-content: end;
            gap: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
<div class="container py-5">
    <div class="registration-card">
        <h4 class="mb-4 text-center">Pendaftaran Pasien Baru</h4>

        <form action="/register-patient" method="post">
            <!-- Visit Info -->
            <div class="row g-3">
                <div class="col-md-6">
                    <label class="form-label">Tanggal Masuk</label>
                    <input type="text" name="visitDate" class="form-control" value="<%= visitTime.split(" ")[0] %>" readonly>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Jam Masuk</label>
                    <input type="text" name="visitTime" class="form-control" value="<%= visitTime.split(" ")[1] %>" readonly>
                </div>
            </div>

            <!-- Patient Info -->
            <div class="form-section-title mt-4">Data Pasien</div>
            <div class="row g-3">
                <div class="col-md-6">
                    <label class="form-label">Nama Pasien</label>
                    <input type="text" name="name" class="form-control" placeholder="Contoh: Ravi Sharma" required>

                    <label class="form-label mt-3">Usia</label>
                    <input type="number" name="age" class="form-control" required>

                    <label class="form-label mt-3">Jenis Kelamin</label>
                    <select name="gender" class="form-select" required>
                        <option value="">Pilih</option>
                        <option>Pria</option>
                        <option>Wanita</option>
                        <option>Lainnya</option>
                    </select>

                    <label class="form-label mt-3">No. Telepon</label>
                    <input type="text" name="phone" class="form-control">
                </div>

                <div class="col-md-6">
                    <label class="form-label">Alamat</label>
                    <textarea name="address" class="form-control" rows="2" required></textarea>

                    <label class="form-label mt-3">Keluhan / Gejala</label>
                    <textarea name="symptoms" class="form-control" rows="2"></textarea>

                    <label class="form-label mt-3">Jenis Kasus</label>
                    <select name="caseType" class="form-select" required>
                        <option value="">Pilih</option>
                        <option>Elektif</option>
                        <option>Darurat</option>
                    </select>
                </div>
            </div>

            <!-- Other Details -->
            <div class="form-section-title mt-4">Info Tambahan</div>
            <div class="row g-3">
                <div class="col-md-6">
                    <label class="form-label">Departemen</label>
                    <select name="department" class="form-select" required>
                        <option>Umum</option>
                        <option>ENT</option>
                        <option>Ortopedi</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Dokter Bertugas</label>
                    <input type="text" name="doctor" class="form-control" value="<%= doctor != null ? doctor.getName() : "" %>" readonly>
                </div>
            </div>

            <!-- Buttons -->
            <div class="btn-group">
                <button type="reset" class="btn btn-outline-secondary">Batalkan</button>
                <button type="submit" class="btn btn-primary">Tambah Pasien</button>
            </div>
        </form>
    </div>
</div>
</body>
</html>
